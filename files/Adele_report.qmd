---
title: "My SpotifyR report"
author: "Joy Lee"
format: 
  html:
    self-contained: true
    toc: true
    theme: default # darkly, cosmo, united, pandoc
knitr: 
  opts_chunk: 
    warning: false
    message: false
editor: visual
---

# Let's talk about Adele

## Who is Adele?

She's just great.

### Her quote

> *"There's a fire starting in my heart"* \
> ― **Adele**

### Her albums

-   19 (released in 2008)

-   21 (2011)

-   25 (2015)

-   30 (2021)

## My picks

### My favorite album

![](images/adele21.jpeg){fig-align="center" width="200"}

### My favorite song

[Hello (2015, YouTube link)](https://youtu.be/YQHsXMglC9A?si=UFSjtoEA2IsdiC_G)

{{< video https://youtu.be/YQHsXMglC9A?si=s8TF-j2RSr5KSlyK >}}

### My favorite lyrics

> *Hello, it's me\
> I was wondering if after all these years you'd like to meet\
> To go over everything\
> They say that time's supposed to heal ya, but I ain't done much healing*
>
> ...

## Data analysis

### Data source

I extracted the data using the `spotifyr` package, and stored it in the data folder.

### Import data

```{r}
# These are packages I need for the analysis
library(ggplot2)
library(dplyr)

# Import data into df
df <- read.csv("data/Adele.csv")
```

### Take a glance of the data frame

```{r}
# Slice 5 random records in the dataframe
df |> dplyr::slice_sample(n=5) |> knitr::kable(digits = 2)
```

## Data preparation

Since there are some duplicated tracks, I've cleaned them. Also, I removed the tracks in live versions of the same songs.

```{r}
# Remove records with the same track names
df <- df |> distinct(track_name, .keep_all = TRUE)
# Filter out track names that include "Live at" or "Live Acoustic"
df <- df |> filter(!grepl("Live at|Live Acoustic", track_name))
# Change the data type of album_name from numeric into character
df$album_name <- as.character(df$album_name)
```

### Album analysis (valence and energy)

```{r}
# Change album_name from character to factor before plotting
df$album_name <- as.factor(df$album_name)
# Plot a boxplot
ggplot(df, aes(x=album_name, y=valence))+
  geom_boxplot()+
  labs(x="Album name", y="Valence")
```

For valence level, the album 25 has the lowest medium. Was she sad when writing the song for the album 25?

```{r}
ggplot(df, aes(x=album_name, y=energy))+
  geom_boxplot()+
  labs(x="Album name", y="Energy")
```

But when looking at the energy level, she's not losing her energy in the album 25!

## Adele's most positive song

Let's look at the 3 most positive songs of her.

```{r}
df |> slice_max(valence, n=3) |> dplyr::select(track_name, album_name, album_release_year, valence) |> knitr::kable(digits = 2)

```

Now look at the 3 most energetic songs.

```{r}
df |> slice_max(energy, n=3) |> dplyr::select(track_name, album_name, album_release_year, energy) |> knitr::kable(digits = 2)
```

Seems like "I'll Be Waiting" is the most positive and energetic song of her. Let's listen to it!

{{< video https://youtu.be/eZqdxfD2yb8?si=zlcj499Qs6qLAbci >}}
